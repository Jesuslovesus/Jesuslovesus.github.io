<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Qrcode Test</title>
    <style>
    .qrcode{
      box-sizing: border-box;
      padding: 10px;
      float: left;
    }
    .qrcode p{
      text-align: center;
    }
    </style>
    
</head>
<body>
    <h1>二维码内容：用大写的"，"分隔开<span id="show"></span></h1>
    <p>可打开手机摄像机测试二维码内容</p>
    <p>
        <textarea id="text" type="textarea">
                小明，1，测试，二维码，内容
        </textarea>
        <button id="btn">点击生成二维码</button>
    </p>
   
    <div id="qrcode-box">
      
    </div>
    
    <p class="col-lg-6 col-md-6" style="text-align: left;" >
        <!-- <a id="download" download="qrcode.jpg"></a> -->
        <!-- <a id="saveQrCode" style="cursor: pointer;">下载二维码</a> -->
    </p>


    <script src="jquery-1.8.3.min.js"></script>
    <script type="text/javascript" src="qrcode.js"></script>
    <script type="text/javascript"> 
    //创建二维码
    function createQRCode(id, url, width, height, src){
        $('#'+id).empty();
        jQuery('#'+id).qrcode({
            render: 'canvas',
            text: url,
            width : width,              //二维码的宽度  
            height : height,            //二维码的高度  
            imgWidth : width/4,         //图片宽
            imgHeight : height/4,       //图片高
            src: src            //图片中央的二维码
        });
    }
    
    $('#btn').click(function(){
      if($('#text').val()){

        var text = $('#text').val()

        var textArr = text.split('，')
        console.log(textArr)
        // $("#show").html($('#text').val())

        for(var i = 0; i < textArr.length; i++){
          $("#qrcode-box").append("<div class='qrcode'><div id='qrcode-" + i + "'></div><p>" + "二维码内容：" + textArr[i] +"</p></div>")
          createQRCode("qrcode-" + i, $('#text').val(), 220, 220, "");

        }

      }
      
    })
    $('#saveQrCode').click(function(){
      var canvas = $('#qrcode').find("canvas").get(0);
      try {//解决IE转base64时缓存不足，canvas转blob下载
          var blob = canvas.msToBlob();
          navigator.msSaveBlob(blob, 'qrcode.jpg');
      } catch (e) {//如果为其他浏览器，使用base64转码下载
          var url = canvas.toDataURL('image/jpeg');
          $("#download").attr('href', url).get(0).click();
      }
      return false;
    });
    </script>
</body>
</html>